Using device: cuda
=== Loading training data ===
Loading seed genes from ../data/GSE54651/liver/seed_genes.txt
Found 12 seed genes
Filtered genes: 9855 -> 10 (kept 10 seed genes)
Initial data shape: (232, 10)
Shape after blunt_percentile: (232, 10)
Scaled expression data shape: (232, 10)
Loading metadata from ../data/GSE54651/liver/metadata.csv
No covariate columns found (looking for _C or _D suffix)
Loading pathway information from ../pathway_dataset/dataset.csv
Built pathway map: 44 pathways covering 10 genes
  Pathway size range: [5, 10]
Pathway statistics:
                                         pathway_name  num_genes
34                              GOBP_RHYTHMIC_PROCESS         10
41                          WP_CIRCADIAN_RHYTHM_GENES          8
19  GOBP_POSITIVE_REGULATION_OF_RNA_METABOLIC_PROCESS          8
13  GOBP_NEGATIVE_REGULATION_OF_NUCLEOBASE_CONTAIN...          7
40                           REACTOME_CIRCADIAN_CLOCK          7
7                               GOBP_CIRCADIAN_RHYTHM          7
21                GOBP_REGULATION_OF_CIRCADIAN_RHYTHM          7
20  GOBP_POSITIVE_REGULATION_OF_TRANSCRIPTION_BY_R...          7
15  GOBP_NEGATIVE_REGULATION_OF_RNA_BIOSYNTHETIC_P...          7
0          GOBP_CELLULAR_RESPONSE_TO_HORMONE_STIMULUS          6
==================================================
Pathway-Based Attention Model
==================================================
Initialized: 44 pathways, 128D embeddings
Epoch 1/200, Cosine Loss: 0.6065
Epoch 51/200, Cosine Loss: 0.5002
Epoch 101/200, Cosine Loss: 0.4013
Epoch 151/200, Cosine Loss: 0.3100
Pearson R=0.17, Spearman œÅ=0.17, Circular R=0.01
plot saved in: results/GSE54651/liver/2025-12-07T21_06_39_greedy/phase_vs_metadata/comparsion.png
Generating final predictions and comparison plot in main save_dir...
Loading test set for Set Transformer evaluation...

=== Loading test data ===
Test data scaled shape: (232, 10)
[WARN] Failed to generate final prediction plot: Expected tensor for argument #1 'indices' to have one of the following scalar types: Long, Int; but got torch.cuda.FloatTensor instead (while checking arguments for embedding)
Training completed. Final ordering obtained from last epoch.

